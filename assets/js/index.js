const firebaseConfig={ apiKey:"AIzaSyBRN5PnCCkUZwcIQcH7v6HiE3S2p474wN8", authDomain:"trst-7237c.firebaseapp.com", projectId:"trst-7237c", storageBucket:"trst-7237c.appspot.com", messagingSenderId:"170480411329", appId:"170480411329" }; firebase.initializeApp(firebaseConfig); const auth=firebase.auth(); const loadingOverlay=document.getElementById('loading-overlay'); const progressBar=document.getElementById('progress-bar'); const loadingText=document.querySelector('.loading-text'); const loginModal=document.getElementById('login-modal'); const loginForm=document.getElementById('login-form'); const loginError=document.getElementById('login-error'); const container=document.querySelector('.container'); const loadingMessages=[ "Loading inventory modules...", "Connecting to database...", "Verifying stock data...", "Preparing dashboard...", "Almost ready..." ]; let progress=0; let messageIndex=0; let isAuthenticated=false; const progressInterval=setInterval(() => { progress += Math.random()*5; if (progress>=100) { progress=100; clearInterval(progressInterval); } progressBar.style.width=progress+'%'; }, 155); const messageInterval=setInterval(() => { if (messageIndex<loadingMessages.length) { loadingText.textContent=loadingMessages[messageIndex]; messageIndex++; } else { clearInterval(messageInterval); } }, 1500); setTimeout(() => { loadingOverlay.style.opacity='0'; loadingOverlay.style.visibility='hidden'; container.style.display='flex'; auth.onAuthStateChanged(user => { if (user) { isAuthenticated=true; } else { setTimeout(() => { loginModal.classList.add('active'); }, 300); } }); }, 7000); loginForm.addEventListener('submit', (e) => { e.preventDefault(); const email=document.getElementById('email').value; const password=document.getElementById('password').value; loginError.textContent=''; const loginBtn=loginForm.querySelector('.login-btn'); loginBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i>Authenticating...'; loginBtn.disabled=true; auth.signInWithEmailAndPassword(email, password) .then((userCredential) => { isAuthenticated=true; loginModal.classList.remove('active'); }) .catch((error) => { loginBtn.innerHTML='<i class="fas fa-sign-in-alt"></i>Login'; loginBtn.disabled=false; let errorMessage="Authentication failed. Please try again."; switch(error.code) { case "auth/user-not-found":errorMessage="User not found."; break; case "auth/wrong-password":errorMessage="Invalid password."; break; case "auth/invalid-email":errorMessage="Invalid email format."; break; case "auth/too-many-requests":errorMessage="Too many attempts. Try again later."; break; } loginError.textContent=errorMessage; loginError.style.animation='shake 0.5s'; setTimeout(() => { loginError.style.animation=''; }, 500); }); }); function openApplication(url) { if (isAuthenticated) { window.location.href=url; } } document.getElementById('herbStock').addEventListener('click', () => openApplication('herb.html')); document.getElementById('vegStock').addEventListener('click', () => openApplication('veg.html')); document.getElementById('fruitStock').addEventListener('click', () => openApplication('fruit.html')); document.getElementById('polStock').addEventListener('click', () => openApplication('polish.html')); document.getElementById('dairyStock').addEventListener('click', () => openApplication('diary.html')); document.getElementById('PrepStock').addEventListener('click', () => openApplication('prepveg.html')); document.getElementById('eggStock').addEventListener('click', () => openApplication('egg.html')); document.getElementById('BreadStock').addEventListener('click', () => openApplication('bread.html')); document.getElementById('nutStock').addEventListener('click', () => openApplication('nutdfruit.html')); document.addEventListener('keydown', function(e) { if (!isAuthenticated) return; switch(e.key) { case '1':openApplication('herb.html'); break; case '2':openApplication('veg.html'); break; case '3':openApplication('fruit.html'); break; case '4':openApplication('polish.html'); break; case '5':openApplication('diary.html'); break; case '6':openApplication('prepveg.html'); break; case '7':openApplication('egg.html'); break; case '8':openApplication('bread.html'); break; case '9':openApplication('nutdfruit.html'); break; } }); const disabledCards=document.querySelectorAll('.app-card.disabled'); disabledCards.forEach(card => { card.addEventListener('click', function(e) { e.preventDefault(); e.stopPropagation(); const warning=document.createElement('div'); warning.innerHTML='<i class="fas fa-exclamation-circle"></i>This module is currently unavailable'; warning.style.position='fixed'; warning.style.bottom='20px'; warning.style.left='50%'; warning.style.transform='translateX(-50%)'; warning.style.backgroundColor='#e74c3c'; warning.style.color='white'; warning.style.padding='10px 20px'; warning.style.borderRadius='8px'; warning.style.zIndex='1000'; warning.style.boxShadow='0 4px 12px rgba(0,0,0,0.2)'; warning.style.fontWeight='bold'; warning.style.opacity='0'; warning.style.transition='opacity 0.3s'; document.body.appendChild(warning); setTimeout(() => { warning.style.opacity='1'; }, 10); setTimeout(() => { warning.style.opacity='0'; setTimeout(() => { document.body.removeChild(warning); }, 300); }, 2000); }); });